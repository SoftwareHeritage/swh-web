{"version":3,"sources":["webpack://swh.admin/webpack/universalModuleDefinition","webpack://swh.admin/./swh/web/assets/src/bundles/admin/deposit.js","webpack://swh.admin/./swh/web/assets/src/bundles/admin/origin-save.js","webpack://swh.admin/./swh/web/assets/src/utils/constants.js","webpack://swh.admin/./swh/web/assets/src/utils/functions.js","webpack://swh.admin/webpack/bootstrap","webpack://swh.admin/webpack/startup","webpack://swh.admin/webpack/runtime/define property getters","webpack://swh.admin/webpack/runtime/hasOwnProperty shorthand","webpack://swh.admin/webpack/runtime/make namespace object"],"names":["root","factory","exports","module","define","amd","self","genSwhLink","data","type","startsWith","Urls","browse_swhid","replace","initDepositAdmin","depositsTable","$","document","ready","fn","dataTable","ext","errMode","on","e","settings","techNote","message","text","DataTable","serverSide","processing","dom","ajax","url","admin_deposit_list","d","excludePattern","val","columns","name","render","row","originPattern","originPatternIdx","indexOf","originUrl","slice","length","nextSepPatternIdx","Date","toLocaleString","JSON","stringify","orderable","visible","scrollX","scrollY","scrollCollapse","order","html","keyup","draw","preventDefault","column","this","attr","removeClass","addClass","authorizedOriginTable","unauthorizedOriginTable","pendingSaveRequestsTable","acceptedSaveRequestsTable","rejectedSaveRequestsTable","enableRowSelection","tableSel","hasClass","closest","find","prop","initOriginSaveAdmin","admin_origin_save_authorized_urls_list","info","swh","webapp","addJumpToPagePopoverToDataTable","admin_origin_save_unauthorized_urls_list","columnsData","searchable","sanitizedURL","display","save_task_status","browseOriginUrl","browse_origin","encodeURIComponent","visit_date","language","swhSpinnerSrc","origin_save_requests_list","searchDelay","responsive","details","push","id","click","reload","target","parents","event","stopPropagation","popover","addAuthorizedOriginUrl","addOriginUrl","admin_origin_save_add_authorized_url","csrfPost","then","handleFetchError","add","htmlAlert","response","removeAuthorizedOriginUrl","removeOriginUrl","admin_origin_save_remove_authorized_url","remove","addUnauthorizedOriginUrl","admin_origin_save_add_unauthorized_url","removeUnauthorizedOriginUrl","admin_origin_save_remove_unauthorized_url","acceptOriginSaveRequest","selectedRow","showModalConfirm","rowData","acceptSaveRequestUrl","admin_origin_save_request_accept","rejectOriginSaveRequest","rejectSaveRequestUrl","admin_origin_save_request_reject","removeOriginSaveRequest","requestTable","requestId","removeSaveRequestUrl","admin_origin_save_request_remove","removePendingOriginSaveRequest","removeAcceptedOriginSaveRequest","removeRejectedOriginSaveRequest","staticAsset","ok","asset","__STATIC__","headers","body","Cookies","get","fetch","credentials","method","closable","closeButton","extraClasses","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","definition","key","o","Object","defineProperty","enumerable","obj","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value"],"mappings":"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","file":"js/admin.3c8067d82a7e375249d4.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"swh\"] = factory();\n\telse\n\t\troot[\"swh\"] = root[\"swh\"] || {}, root[\"swh\"][\"admin\"] = factory();\n})(self, function() {\nreturn ","/**\n * Copyright (C) 2018-2020  The Software Heritage developers\n * See the AUTHORS file at the top-level directory of this distribution\n * License: GNU Affero General Public License version 3, or any later version\n * See top-level LICENSE file for more information\n */\n\nfunction genSwhLink(data, type) {\n  if (type === 'display') {\n    if (data && data.startsWith('swh')) {\n      const browseUrl = Urls.browse_swhid(data);\n      const formattedSWHID = data.replace(/;/g, ';<br/>');\n      return `<a href=\"${browseUrl}\">${formattedSWHID}</a>`;\n    }\n  }\n  return data;\n}\n\nexport function initDepositAdmin() {\n  let depositsTable;\n  $(document).ready(() => {\n    $.fn.dataTable.ext.errMode = 'none';\n    depositsTable = $('#swh-admin-deposit-list')\n      .on('error.dt', (e, settings, techNote, message) => {\n        $('#swh-admin-deposit-list-error').text(message);\n      })\n      .DataTable({\n        serverSide: true,\n        processing: true,\n        // let's define the order of table options display\n        // f: (f)ilter\n        // l: (l)ength changing\n        // r: p(r)ocessing\n        // t: (t)able\n        // i: (i)nfo\n        // p: (p)agination\n        // see https://datatables.net/examples/basic_init/dom.html\n        dom: '<<\"d-flex justify-content-between align-items-center\"f' +\n             '<\"#list-exclude\">l>rt<\"bottom\"ip>>',\n        // div#list-exclude is a custom filter added next to dataTable\n        // initialization below through js dom manipulation, see\n        // https://datatables.net/examples/advanced_init/dom_toolbar.html\n        ajax: {\n          url: Urls.admin_deposit_list(),\n          data: d => {\n            d.excludePattern = $('#swh-admin-deposit-list-exclude-filter').val();\n          }\n        },\n        columns: [\n          {\n            data: 'id',\n            name: 'id'\n          },\n          {\n            data: 'swhid_context',\n            name: 'swhid_context',\n            render: (data, type, row) => {\n              if (data && type === 'display') {\n                let originPattern = ';origin=';\n                let originPatternIdx = data.indexOf(originPattern);\n                if (originPatternIdx !== -1) {\n                  let originUrl = data.slice(originPatternIdx + originPattern.length);\n                  let nextSepPattern = ';';\n                  let nextSepPatternIdx = originUrl.indexOf(nextSepPattern);\n                  if (nextSepPatternIdx !== -1) { /* Remove extra context */\n                    originUrl = originUrl.slice(0, nextSepPatternIdx);\n                  }\n                  return `<a href=\"${originUrl}\">${originUrl}</a>`;\n                }\n              }\n              return data;\n            }\n          },\n          {\n            data: 'reception_date',\n            name: 'reception_date',\n            render: (data, type, row) => {\n              if (type === 'display') {\n                let date = new Date(data);\n                return date.toLocaleString();\n              }\n              return data;\n            }\n          },\n          {\n            data: 'status',\n            name: 'status'\n          },\n          {\n            data: 'status_detail',\n            name: 'status_detail',\n            render: (data, type, row) => {\n              if (type === 'display' && data) {\n                let text = data;\n                if (typeof data === 'object') {\n                  text = JSON.stringify(data, null, 4);\n                }\n                return `<div style=\"width: 200px; white-space: pre; overflow-x: auto;\">${text}</div>`;\n              }\n              return data;\n            },\n            orderable: false,\n            visible: false\n          },\n          {\n            data: 'swhid',\n            name: 'swhid',\n            render: (data, type, row) => {\n              return genSwhLink(data, type);\n            },\n            orderable: false,\n            visible: false\n          },\n          {\n            data: 'swhid_context',\n            name: 'swhid_context',\n            render: (data, type, row) => {\n              return genSwhLink(data, type);\n            },\n            orderable: false,\n            visible: false\n          }\n        ],\n        scrollX: true,\n        scrollY: '50vh',\n        scrollCollapse: true,\n        order: [[0, 'desc']]\n      });\n\n    // Some more customization is needed on the table\n    $('div#list-exclude').html(`<div id=\"swh-admin-deposit-list-exclude-wrapper\">\n    <div id=\"swh-admin-deposit-list-exclude-div-wrapper\" class=\"dataTables_filter\">\n      <label>\n        Exclude:<input id=\"swh-admin-deposit-list-exclude-filter\"\n                       type=\"search\"\n                       value=\"check-deposit\"\n                       class=\"form-control form-control-sm\"\n                       placeholder=\"exclude-pattern\" aria-controls=\"swh-admin-deposit-list\">\n          </input>\n      </label>\n    </div>\n  </div>\n`);\n    // Adding exclusion pattern update behavior, when typing, update search\n    $('#swh-admin-deposit-list-exclude-filter').keyup(function() {\n      depositsTable.draw();\n    });\n    // at last draw the table\n    depositsTable.draw();\n  });\n\n  $('a.toggle-col').on('click', function(e) {\n    e.preventDefault();\n    var column = depositsTable.column($(this).attr('data-column'));\n    column.visible(!column.visible());\n    if (column.visible()) {\n      $(this).removeClass('col-hidden');\n    } else {\n      $(this).addClass('col-hidden');\n    }\n  });\n\n}\n","/**\n * Copyright (C) 2018-2020  The Software Heritage developers\n * See the AUTHORS file at the top-level directory of this distribution\n * License: GNU Affero General Public License version 3, or any later version\n * See top-level LICENSE file for more information\n */\n\nimport {handleFetchError, csrfPost, htmlAlert} from 'utils/functions';\nimport {swhSpinnerSrc} from 'utils/constants';\n\nlet authorizedOriginTable;\nlet unauthorizedOriginTable;\nlet pendingSaveRequestsTable;\nlet acceptedSaveRequestsTable;\nlet rejectedSaveRequestsTable;\n\nfunction enableRowSelection(tableSel) {\n  $(`${tableSel} tbody`).on('click', 'tr', function() {\n    if ($(this).hasClass('selected')) {\n      $(this).removeClass('selected');\n      $(tableSel).closest('.tab-pane').find('.swh-action-need-selection').prop('disabled', true);\n    } else {\n      $(`${tableSel} tr.selected`).removeClass('selected');\n      $(this).addClass('selected');\n      $(tableSel).closest('.tab-pane').find('.swh-action-need-selection').prop('disabled', false);\n    }\n  });\n}\n\nexport function initOriginSaveAdmin() {\n  $(document).ready(() => {\n\n    $.fn.dataTable.ext.errMode = 'throw';\n\n    authorizedOriginTable = $('#swh-authorized-origin-urls').DataTable({\n      serverSide: true,\n      ajax: Urls.admin_origin_save_authorized_urls_list(),\n      columns: [{data: 'url', name: 'url'}],\n      scrollY: '50vh',\n      scrollCollapse: true,\n      info: false\n    });\n    enableRowSelection('#swh-authorized-origin-urls');\n    swh.webapp.addJumpToPagePopoverToDataTable(authorizedOriginTable);\n\n    unauthorizedOriginTable = $('#swh-unauthorized-origin-urls').DataTable({\n      serverSide: true,\n      ajax: Urls.admin_origin_save_unauthorized_urls_list(),\n      columns: [{data: 'url', name: 'url'}],\n      scrollY: '50vh',\n      scrollCollapse: true,\n      info: false\n    });\n    enableRowSelection('#swh-unauthorized-origin-urls');\n    swh.webapp.addJumpToPagePopoverToDataTable(unauthorizedOriginTable);\n\n    let columnsData = [\n      {\n        data: 'id',\n        name: 'id',\n        visible: false,\n        searchable: false\n      },\n      {\n        data: 'save_request_date',\n        name: 'request_date',\n        render: (data, type, row) => {\n          if (type === 'display') {\n            let date = new Date(data);\n            return date.toLocaleString();\n          }\n          return data;\n        }\n      },\n      {\n        data: 'visit_type',\n        name: 'visit_type'\n      },\n      {\n        data: 'origin_url',\n        name: 'origin_url',\n        render: (data, type, row) => {\n          if (type === 'display') {\n            let html = '';\n            const sanitizedURL = $.fn.dataTable.render.text().display(data);\n            if (row.save_task_status === 'succeed') {\n              let browseOriginUrl = `${Urls.browse_origin()}?origin_url=${encodeURIComponent(sanitizedURL)}`;\n              if (row.visit_date) {\n                browseOriginUrl += `&amp;timestamp=${encodeURIComponent(row.visit_date)}`;\n              }\n              html += `<a href=\"${browseOriginUrl}\">${sanitizedURL}</a>`;\n            } else {\n              html += sanitizedURL;\n            }\n            html += `&nbsp;<a href=\"${sanitizedURL}\"><i class=\"mdi mdi-open-in-new\" aria-hidden=\"true\"></i></a>`;\n            return html;\n          }\n          return data;\n        }\n      }\n    ];\n\n    pendingSaveRequestsTable = $('#swh-origin-save-pending-requests').DataTable({\n      serverSide: true,\n      processing: true,\n      language: {\n        processing: `<img src=\"${swhSpinnerSrc}\"></img>`\n      },\n      ajax: Urls.origin_save_requests_list('pending'),\n      searchDelay: 1000,\n      columns: columnsData,\n      scrollY: '50vh',\n      scrollCollapse: true,\n      order: [[0, 'desc']],\n      responsive: {\n        details: {\n          type: 'none'\n        }\n      }\n    });\n    enableRowSelection('#swh-origin-save-pending-requests');\n    swh.webapp.addJumpToPagePopoverToDataTable(pendingSaveRequestsTable);\n\n    rejectedSaveRequestsTable = $('#swh-origin-save-rejected-requests').DataTable({\n      serverSide: true,\n      processing: true,\n      language: {\n        processing: `<img src=\"${swhSpinnerSrc}\"></img>`\n      },\n      ajax: Urls.origin_save_requests_list('rejected'),\n      searchDelay: 1000,\n      columns: columnsData,\n      scrollY: '50vh',\n      scrollCollapse: true,\n      order: [[0, 'desc']],\n      responsive: {\n        details: {\n          type: 'none'\n        }\n      }\n    });\n    enableRowSelection('#swh-origin-save-rejected-requests');\n    swh.webapp.addJumpToPagePopoverToDataTable(rejectedSaveRequestsTable);\n\n    columnsData.push({\n      data: 'save_task_status',\n      name: 'save_task_status'\n    });\n\n    columnsData.push({\n      name: 'info',\n      render: (data, type, row) => {\n        if (row.save_task_status === 'succeed' || row.save_task_status === 'failed') {\n          return '<i class=\"mdi mdi-information-outline swh-save-request-info\" aria-hidden=\"true\" style=\"cursor: pointer\"' +\n                  `onclick=\"swh.save.displaySaveRequestInfo(event, ${row.id})\"></i>`;\n        } else {\n          return '';\n        }\n      }\n    });\n\n    acceptedSaveRequestsTable = $('#swh-origin-save-accepted-requests').DataTable({\n      serverSide: true,\n      processing: true,\n      language: {\n        processing: `<img src=\"${swhSpinnerSrc}\"></img>`\n      },\n      ajax: Urls.origin_save_requests_list('accepted'),\n      searchDelay: 1000,\n      columns: columnsData,\n      scrollY: '50vh',\n      scrollCollapse: true,\n      order: [[0, 'desc']],\n      responsive: {\n        details: {\n          type: 'none'\n        }\n      }\n    });\n    enableRowSelection('#swh-origin-save-accepted-requests');\n    swh.webapp.addJumpToPagePopoverToDataTable(acceptedSaveRequestsTable);\n\n    $('#swh-origin-save-requests-nav-item').on('shown.bs.tab', () => {\n      pendingSaveRequestsTable.draw();\n    });\n\n    $('#swh-origin-save-url-filters-nav-item').on('shown.bs.tab', () => {\n      authorizedOriginTable.draw();\n    });\n\n    $('#swh-authorized-origins-tab').on('shown.bs.tab', () => {\n      authorizedOriginTable.draw();\n    });\n\n    $('#swh-unauthorized-origins-tab').on('shown.bs.tab', () => {\n      unauthorizedOriginTable.draw();\n    });\n\n    $('#swh-save-requests-pending-tab').on('shown.bs.tab', () => {\n      pendingSaveRequestsTable.draw();\n    });\n\n    $('#swh-save-requests-accepted-tab').on('shown.bs.tab', () => {\n      acceptedSaveRequestsTable.draw();\n    });\n\n    $('#swh-save-requests-rejected-tab').on('shown.bs.tab', () => {\n      rejectedSaveRequestsTable.draw();\n    });\n\n    $('#swh-save-requests-pending-tab').click(() => {\n      pendingSaveRequestsTable.ajax.reload(null, false);\n    });\n\n    $('#swh-save-requests-accepted-tab').click(() => {\n      acceptedSaveRequestsTable.ajax.reload(null, false);\n    });\n\n    $('#swh-save-requests-rejected-tab').click(() => {\n      rejectedSaveRequestsTable.ajax.reload(null, false);\n    });\n\n    $('body').on('click', e => {\n      if ($(e.target).parents('.popover').length > 0) {\n        event.stopPropagation();\n      } else if ($(e.target).parents('.swh-save-request-info').length === 0) {\n        $('.swh-save-request-info').popover('dispose');\n      }\n    });\n\n  });\n}\n\nexport function addAuthorizedOriginUrl() {\n  let originUrl = $('#swh-authorized-url-prefix').val();\n  let addOriginUrl = Urls.admin_origin_save_add_authorized_url(originUrl);\n  csrfPost(addOriginUrl)\n    .then(handleFetchError)\n    .then(() => {\n      authorizedOriginTable.row.add({'url': originUrl}).draw();\n      $('.swh-add-authorized-origin-status').html(\n        htmlAlert('success', 'The origin url prefix has been successfully added in the authorized list.', true)\n      );\n    })\n    .catch(response => {\n      $('.swh-add-authorized-origin-status').html(\n        htmlAlert('warning', 'The provided origin url prefix is already registered in the authorized list.', true)\n      );\n    });\n}\n\nexport function removeAuthorizedOriginUrl() {\n  let originUrl = $('#swh-authorized-origin-urls tr.selected').text();\n  if (originUrl) {\n    let removeOriginUrl = Urls.admin_origin_save_remove_authorized_url(originUrl);\n    csrfPost(removeOriginUrl)\n      .then(handleFetchError)\n      .then(() => {\n        authorizedOriginTable.row('.selected').remove().draw();\n      })\n      .catch(() => {});\n  }\n}\n\nexport function addUnauthorizedOriginUrl() {\n  let originUrl = $('#swh-unauthorized-url-prefix').val();\n  let addOriginUrl = Urls.admin_origin_save_add_unauthorized_url(originUrl);\n  csrfPost(addOriginUrl)\n    .then(handleFetchError)\n    .then(() => {\n      unauthorizedOriginTable.row.add({'url': originUrl}).draw();\n      $('.swh-add-unauthorized-origin-status').html(\n        htmlAlert('success', 'The origin url prefix has been successfully added in the unauthorized list.', true)\n      );\n    })\n    .catch(() => {\n      $('.swh-add-unauthorized-origin-status').html(\n        htmlAlert('warning', 'The provided origin url prefix is already registered in the unauthorized list.', true)\n      );\n    });\n}\n\nexport function removeUnauthorizedOriginUrl() {\n  let originUrl = $('#swh-unauthorized-origin-urls tr.selected').text();\n  if (originUrl) {\n    let removeOriginUrl = Urls.admin_origin_save_remove_unauthorized_url(originUrl);\n    csrfPost(removeOriginUrl)\n      .then(handleFetchError)\n      .then(() => {\n        unauthorizedOriginTable.row('.selected').remove().draw();\n      })\n      .catch(() => {});\n  }\n}\n\nexport function acceptOriginSaveRequest() {\n  let selectedRow = pendingSaveRequestsTable.row('.selected');\n  if (selectedRow.length) {\n    let acceptOriginSaveRequestCallback = () => {\n      let rowData = selectedRow.data();\n      let acceptSaveRequestUrl = Urls.admin_origin_save_request_accept(rowData['visit_type'], rowData['origin_url']);\n      csrfPost(acceptSaveRequestUrl)\n        .then(() => {\n          pendingSaveRequestsTable.ajax.reload(null, false);\n        });\n    };\n\n    swh.webapp.showModalConfirm(\n      'Accept origin save request ?',\n      'Are you sure to accept this origin save request ?',\n      acceptOriginSaveRequestCallback);\n  }\n}\n\nexport function rejectOriginSaveRequest() {\n  let selectedRow = pendingSaveRequestsTable.row('.selected');\n  if (selectedRow.length) {\n    let rejectOriginSaveRequestCallback = () => {\n      let rowData = selectedRow.data();\n      let rejectSaveRequestUrl = Urls.admin_origin_save_request_reject(rowData['visit_type'], rowData['origin_url']);\n      csrfPost(rejectSaveRequestUrl)\n        .then(() => {\n          pendingSaveRequestsTable.ajax.reload(null, false);\n        });\n    };\n\n    swh.webapp.showModalConfirm(\n      'Reject origin save request ?',\n      'Are you sure to reject this origin save request ?',\n      rejectOriginSaveRequestCallback);\n  }\n}\n\nfunction removeOriginSaveRequest(requestTable) {\n  let selectedRow = requestTable.row('.selected');\n  if (selectedRow.length) {\n    let requestId = selectedRow.data()['id'];\n    let removeOriginSaveRequestCallback = () => {\n      let removeSaveRequestUrl = Urls.admin_origin_save_request_remove(requestId);\n      csrfPost(removeSaveRequestUrl)\n        .then(() => {\n          requestTable.ajax.reload(null, false);\n        });\n    };\n\n    swh.webapp.showModalConfirm(\n      'Remove origin save request ?',\n      'Are you sure to remove this origin save request ?',\n      removeOriginSaveRequestCallback);\n  }\n}\n\nexport function removePendingOriginSaveRequest() {\n  removeOriginSaveRequest(pendingSaveRequestsTable);\n}\n\nexport function removeAcceptedOriginSaveRequest() {\n  removeOriginSaveRequest(acceptedSaveRequestsTable);\n}\n\nexport function removeRejectedOriginSaveRequest() {\n  removeOriginSaveRequest(rejectedSaveRequestsTable);\n}\n","/**\n * Copyright (C) 2019  The Software Heritage developers\n * See the AUTHORS file at the top-level directory of this distribution\n * License: GNU Affero General Public License version 3, or any later version\n * See top-level LICENSE file for more information\n */\n\nimport {staticAsset} from 'utils/functions';\n\n// Constants defining Bootstrap Breakpoints\nexport const BREAKPOINT_SM = 768;\nexport const BREAKPOINT_MD = 992;\nexport const BREAKPOINT_LG = 1200;\n\nexport const swhSpinnerSrc = staticAsset('img/swh-spinner.gif');\n","/**\n * Copyright (C) 2018-2020  The Software Heritage developers\n * See the AUTHORS file at the top-level directory of this distribution\n * License: GNU Affero General Public License version 3, or any later version\n * See top-level LICENSE file for more information\n */\n\n// utility functions\n\nexport function handleFetchError(response) {\n  if (!response.ok) {\n    throw response;\n  }\n  return response;\n}\n\nexport function handleFetchErrors(responses) {\n  for (let i = 0; i < responses.length; ++i) {\n    if (!responses[i].ok) {\n      throw responses[i];\n    }\n  }\n  return responses;\n}\n\nexport function staticAsset(asset) {\n  return `${__STATIC__}${asset}`;\n}\n\nexport function csrfPost(url, headers = {}, body = null) {\n  headers['X-CSRFToken'] = Cookies.get('csrftoken');\n  return fetch(url, {\n    credentials: 'include',\n    headers: headers,\n    method: 'POST',\n    body: body\n  });\n}\n\nexport function isGitRepoUrl(url, pathPrefix = '/') {\n  let allowedProtocols = ['http:', 'https:', 'git:'];\n  if (allowedProtocols.find(protocol => protocol === url.protocol) === undefined) {\n    return false;\n  }\n  if (!url.pathname.startsWith(pathPrefix)) {\n    return false;\n  }\n  let re = new RegExp('[\\\\w\\\\.-]+\\\\/?(?!=.git)(?:\\\\.git\\\\/?)?$');\n  return re.test(url.pathname.slice(pathPrefix.length));\n};\n\nexport function removeUrlFragment() {\n  history.replaceState('', document.title, window.location.pathname + window.location.search);\n}\n\nexport function selectText(startNode, endNode) {\n  let selection = window.getSelection();\n  selection.removeAllRanges();\n  let range = document.createRange();\n  range.setStart(startNode, 0);\n  if (endNode.nodeName !== '#text') {\n    range.setEnd(endNode, endNode.childNodes.length);\n  } else {\n    range.setEnd(endNode, endNode.textContent.length);\n  }\n  selection.addRange(range);\n}\n\nexport function htmlAlert(type, message, closable = false) {\n  let closeButton = '';\n  let extraClasses = '';\n  if (closable) {\n    closeButton =\n      `<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n        <span aria-hidden=\"true\">&times;</span>\n      </button>`;\n    extraClasses = 'alert-dismissible';\n  }\n  return `<div class=\"alert alert-${type} ${extraClasses}\" role=\"alert\">${message}${closeButton}</div>`;\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// module exports must be returned from runtime so entry inlining is disabled\n// startup\n// Load entry module and return exports\nreturn __webpack_require__(31818);\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}